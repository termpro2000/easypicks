<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ë˜ì½”ë¦¬ì•„ ë°°ì†¡ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background-color: #fff;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header {
            background-color: #2196F3;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .hamburger {
            font-size: 24px;
            cursor: pointer;
        }

        .date-nav {
            background-color: #fff;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .date-nav button {
            background: none;
            border: none;
            font-size: 18px;
            color: #2196F3;
            cursor: pointer;
        }

        .current-date {
            font-size: 16px;
            font-weight: 500;
        }

        .stats {
            background-color: #f8f9fa;
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #e0e0e0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 600;
            color: #2196F3;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .delivery-list {
            padding: 20px;
        }

        .delivery-card {
            background-color: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #4CAF50;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .delivery-card:hover {
            transform: translateY(-2px);
        }

        .delivery-card.pending {
            border-left-color: #FF9800;
        }

        .delivery-card.in-transit {
            border-left-color: #2196F3;
        }

        .delivery-card.delivered {
            border-left-color: #4CAF50;
        }

        .delivery-card.cancelled {
            border-left-color: #f44336;
        }

        .delivery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .tracking-number {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
        }

        .status-badge.pending { background-color: #FF9800; }
        .status-badge.in-transit { background-color: #2196F3; }
        .status-badge.delivered { background-color: #4CAF50; }
        .status-badge.cancelled { background-color: #f44336; }

        .customer-name {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .customer-address {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .delivery-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #888;
        }

        .login-container {
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
        }

        .login-title {
            font-size: 28px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 40px;
            color: #2196F3;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #2196F3;
        }

        .btn-primary {
            width: 100%;
            padding: 14px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #1976D2;
        }

        .btn-secondary {
            width: 100%;
            padding: 14px;
            background-color: transparent;
            color: #2196F3;
            border: 1px solid #2196F3;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 12px;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background-color: #2196F3;
            color: white;
        }

        .hidden {
            display: none;
        }

        .detail-container {
            padding: 20px;
        }

        .back-button {
            background: none;
            border: none;
            color: #2196F3;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .detail-section {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 8px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-label {
            font-weight: 500;
            color: #666;
            flex: 1;
        }

        .detail-value {
            flex: 2;
            text-align: right;
            color: #333;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ë¡œê·¸ì¸ í™”ë©´ -->
        <div id="loginScreen" class="login-container">
            <h1 class="login-title">ğŸšš ë¯¸ë˜ì½”ë¦¬ì•„<br>ë°°ì†¡ ê´€ë¦¬</h1>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">ì‚¬ìš©ì ID</label>
                    <input type="text" class="form-input" id="userId" placeholder="ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="form-input" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <button type="submit" class="btn-primary">ë¡œê·¸ì¸</button>
                <button type="button" class="btn-secondary" onclick="showRegister()">íšŒì›ê°€ì…</button>
            </form>
        </div>

        <!-- íšŒì›ê°€ì… í™”ë©´ -->
        <div id="registerScreen" class="login-container hidden">
            <h1 class="login-title">íšŒì›ê°€ì…</h1>
            
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label">ì‚¬ìš©ì ID</label>
                    <input type="text" class="form-input" id="regUserId" placeholder="ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="form-input" id="regPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ì´ë¦„</label>
                    <input type="text" class="form-input" id="regName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>

                <div class="form-group">
                    <label class="form-label">ì „í™”ë²ˆí˜¸</label>
                    <input type="tel" class="form-input" id="regPhone" placeholder="ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                
                <button type="submit" class="btn-primary">íšŒì›ê°€ì…</button>
                <button type="button" class="btn-secondary" onclick="showLogin()">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </form>
        </div>

        <!-- ë°°ì†¡ ëª©ë¡ í™”ë©´ -->
        <div id="deliveryListScreen" class="hidden">
            <div class="header">
                <span class="hamburger">â˜°</span>
                <h1>ë¯¸ë˜ì½”ë¦¬ì•„ ë°°ì†¡ê´€ë¦¬</h1>
                <span onclick="logout()" style="cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</span>
            </div>

            <div class="date-nav">
                <button onclick="changeDate(-1)">â€¹</button>
                <span class="current-date" id="currentDate">2024ë…„ 1ì›” 15ì¼</span>
                <button onclick="changeDate(1)">â€º</button>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalCount">5</div>
                    <div class="stat-label">ì „ì²´ê±´ìˆ˜</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="completedCount">2</div>
                    <div class="stat-label">ì™„ë£Œê±´ìˆ˜</div>
                </div>
            </div>

            <div class="delivery-list" id="deliveryList">
                <!-- ë°°ì†¡ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ë°°ì†¡ ìƒì„¸ í™”ë©´ -->
        <div id="deliveryDetailScreen" class="hidden">
            <div class="header">
                <button class="back-button" onclick="showDeliveryList()">â† ë’¤ë¡œ</button>
                <h1>ë°°ì†¡ ìƒì„¸ì •ë³´</h1>
                <span></span>
            </div>

            <div class="detail-container" id="detailContent">
                <!-- ìƒì„¸ ì •ë³´ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';
        let authToken = localStorage.getItem('token') || '';
        let currentUser = null;
        let currentDate = new Date();
        let deliveries = [];

        // ë”ë¯¸ ë°°ì†¡ ë°ì´í„°
        const dummyDeliveries = [
            {
                id: 1,
                tracking_number: 'MK202401001',
                customerName: 'ê¹€ì² ìˆ˜',
                customerPhone: '010-1234-5678',
                customerAddress: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123, 101ë™ 502í˜¸',
                assignedDriver: 'ì´ê¸°ì‚¬',
                assignmentTime: '09:30',
                status: 'pending',
                requestType: 'ìƒˆê°€êµ¬ ë°°ì†¡',
                constructionType: 'ì¡°ë¦½ ì„¤ì¹˜',
                shipmentType: 'ì§ë°°ì†¡',
                visitDate: '2024-01-15',
                visitTime: '14:00-16:00',
                furnitureCompany: 'í•œìƒ˜ê°€êµ¬',
                emergencyContact: '010-9999-8888',
                warehouseInfo: 'ê¹€í¬ë¬¼ë¥˜ì„¼í„°',
                orderGuidance: 'ì™„ë£Œ',
                preNotification: 'í•„ìš”',
                buildingType: 'ì•„íŒŒíŠ¸',
                floorCount: '5ì¸µ',
                elevatorAvailable: 'ìˆìŒ',
                stairMovement: 'ë¶ˆí•„ìš”',
                ladderTruck: 'ë¶ˆí•„ìš”',
                disposal: 'ì—†ìŒ',
                roomMovement: 'ê±°ì‹¤â†’ì¹¨ì‹¤',
                wallConstruction: 'ë²½ê±¸ì´ TV',
                tollgateCost: '5,000ì›',
                mainMemo: 'ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ìš´ë°˜ ìš”ì²­',
                happyCallMemo: 'ê³ ê° ë§¤ìš° ë§Œì¡±',
                productInfo: 'ì¹¨ì‹¤ì„¸íŠ¸ (ì¹¨ëŒ€, ì˜·ì¥, í™”ì¥ëŒ€)',
                furnitureRequest: 'ìŠ¤í¬ë˜ì¹˜ ì£¼ì˜',
                driverMemo: 'ì£¼ì°¨ ì–´ë ¤ì›€'
            },
            {
                id: 2,
                tracking_number: 'MK202401002',
                customerName: 'ë°•ì˜í¬',
                customerPhone: '010-2345-6789',
                customerAddress: 'ë¶€ì‚°ì‹œ í•´ìš´ëŒ€êµ¬ ë§ˆë¦°ì‹œí‹° 456, 202í˜¸',
                assignedDriver: 'ê¹€ê¸°ì‚¬',
                assignmentTime: '10:15',
                status: 'in_transit',
                requestType: 'ìƒˆê°€êµ¬ ë°°ì†¡',
                constructionType: 'ì¡°ë¦½ ì„¤ì¹˜',
                productInfo: 'ì†ŒíŒŒì„¸íŠ¸ (3ì¸ì†ŒíŒŒ, 2ì¸ì†ŒíŒŒ, í…Œì´ë¸”)'
            },
            {
                id: 3,
                tracking_number: 'MK202401003',
                customerName: 'ìµœë¯¼ìˆ˜',
                customerPhone: '010-3456-7890',
                customerAddress: 'ëŒ€êµ¬ì‹œ ìˆ˜ì„±êµ¬ ë™ëŒ€êµ¬ë¡œ 321, ë¹Œë¼ 3ì¸µ',
                assignedDriver: 'ë°•ê¸°ì‚¬',
                assignmentTime: '11:30',
                status: 'delivered',
                requestType: 'ìƒˆê°€êµ¬ ë°°ì†¡',
                constructionType: 'ì¡°ë¦½ ì„¤ì¹˜',
                productInfo: 'ì¹¨ì‹¤ì„¸íŠ¸ (ì¹¨ëŒ€, ë§¤íŠ¸ë¦¬ìŠ¤)'
            },
            {
                id: 4,
                tracking_number: 'MK202401004',
                customerName: 'ì •ìˆ˜ì§„',
                customerPhone: '010-4567-8901',
                customerAddress: 'ì¸ì²œì‹œ ë‚¨ë™êµ¬ êµ¬ì›”ë¡œ 789, ì•„íŒŒíŠ¸ 15ë™ 1205í˜¸',
                assignedDriver: 'ì´ê¸°ì‚¬',
                assignmentTime: '13:45',
                status: 'pending',
                requestType: 'ìƒˆê°€êµ¬ ë°°ì†¡',
                constructionType: 'ì¡°ë¦½ ì„¤ì¹˜',
                productInfo: 'ì£¼ë°©ê°€êµ¬ (ì‹±í¬ëŒ€, ìˆ˜ë‚©ì¥)'
            },
            {
                id: 5,
                tracking_number: 'MK202401005',
                customerName: 'í™ê¸¸ë™',
                customerPhone: '010-5678-9012',
                customerAddress: 'ê´‘ì£¼ì‹œ ì„œêµ¬ ìƒë¬´ëŒ€ë¡œ 654, ì˜¤í”¼ìŠ¤í…” 1201í˜¸',
                assignedDriver: 'ê¹€ê¸°ì‚¬',
                assignmentTime: '14:30',
                status: 'cancelled',
                requestType: 'ìƒˆê°€êµ¬ ë°°ì†¡',
                constructionType: 'ì¡°ë¦½ ì„¤ì¹˜',
                productInfo: 'ì‚¬ë¬´ìš© ì±…ìƒ ë° ì˜ì'
            }
        ];

        // ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', function() {
            if (authToken) {
                showDeliveryList();
            } else {
                showLogin();
            }
        });

        // í™”ë©´ ì „í™˜ í•¨ìˆ˜ë“¤
        function showLogin() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
        }

        function showDeliveryList() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.remove('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
            
            loadDeliveries();
            updateDateDisplay();
            updateStats();
        }

        function showDeliveryDetail(delivery) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.remove('hidden');
            
            loadDeliveryDetail(delivery);
        }

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userId = document.getElementById('userId').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId, password })
                });

                const result = await response.json();
                
                if (response.ok && result.token) {
                    authToken = result.token;
                    currentUser = result.user;
                    localStorage.setItem('token', authToken);
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    showDeliveryList();
                } else {
                    alert(result.error || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                alert('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // íšŒì›ê°€ì… ì²˜ë¦¬
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const user_id = document.getElementById('regUserId').value;
            const password = document.getElementById('regPassword').value;
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;

            try {
                const response = await fetch(`${API_BASE}/api/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id, password, name, phone })
                });

                const result = await response.json();
                
                if (response.ok) {
                    alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                    showLogin();
                } else {
                    alert(result.error || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íšŒì›ê°€ì… ì˜¤ë¥˜:', error);
                alert('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ë°°ì†¡ ëª©ë¡ ë¡œë“œ
        async function loadDeliveries() {
            try {
                const response = await fetch(`${API_BASE}/api/delivery/list`, {
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    deliveries = result.deliveries || dummyDeliveries;
                } else {
                    deliveries = dummyDeliveries;
                }
            } catch (error) {
                console.error('ë°°ì†¡ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                deliveries = dummyDeliveries;
            }

            renderDeliveryList();
        }

        // ë°°ì†¡ ëª©ë¡ ë Œë”ë§
        function renderDeliveryList() {
            const listContainer = document.getElementById('deliveryList');
            listContainer.innerHTML = '';

            deliveries.forEach(delivery => {
                const card = document.createElement('div');
                card.className = `delivery-card ${delivery.status}`;
                card.onclick = () => showDeliveryDetail(delivery);
                
                card.innerHTML = `
                    <div class="delivery-header">
                        <span class="tracking-number">${delivery.tracking_number}</span>
                        <span class="status-badge ${delivery.status}">${getStatusText(delivery.status)}</span>
                    </div>
                    <div class="customer-name">${delivery.customerName || delivery.receiver_name}</div>
                    <div class="customer-address">${delivery.customerAddress || delivery.receiver_address}</div>
                    <div class="delivery-info">
                        <span>ê¸°ì‚¬: ${delivery.assignedDriver || 'ë¯¸ë°°ì •'}</span>
                        <span>ì‹œê°„: ${delivery.assignmentTime || 'ë¯¸ì •'}</span>
                    </div>
                `;
                
                listContainer.appendChild(card);
            });
        }

        // ìƒíƒœ í…ìŠ¤íŠ¸ ë³€í™˜
        function getStatusText(status) {
            const statusMap = {
                'pending': 'ëŒ€ê¸°ì¤‘',
                'in_transit': 'ë°°ì†¡ì¤‘',
                'delivered': 'ì™„ë£Œ',
                'cancelled': 'ì·¨ì†Œ'
            };
            return statusMap[status] || status;
        }

        // ë°°ì†¡ ìƒì„¸ ì •ë³´ ë¡œë“œ
        function loadDeliveryDetail(delivery) {
            const detailContent = document.getElementById('detailContent');
            
            detailContent.innerHTML = `
                <div class="detail-section">
                    <h3 class="section-title">ê¸°ë³¸ ì •ë³´</h3>
                    <div class="detail-item">
                        <span class="detail-label">ìš´ì†¡ì¥ë²ˆí˜¸</span>
                        <span class="detail-value">${delivery.tracking_number}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ê³ ê°ëª…</span>
                        <span class="detail-value">${delivery.customerName || delivery.receiver_name}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ì—°ë½ì²˜</span>
                        <span class="detail-value">${delivery.customerPhone || delivery.receiver_phone}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ë°°ì†¡ìƒíƒœ</span>
                        <span class="detail-value">${getStatusText(delivery.status)}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3 class="section-title">ë°°ì†¡ ì£¼ì†Œ</h3>
                    <div class="detail-item">
                        <span class="detail-label">ì£¼ì†Œ</span>
                        <span class="detail-value">${delivery.customerAddress || delivery.receiver_address}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3 class="section-title">ë°°ì†¡ ì •ë³´</h3>
                    <div class="detail-item">
                        <span class="detail-label">ìš”ì²­ì‚¬í•­</span>
                        <span class="detail-value">${delivery.requestType || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ì‹œê³µìœ í˜•</span>
                        <span class="detail-value">${delivery.constructionType || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ìƒí’ˆì •ë³´</span>
                        <span class="detail-value">${delivery.productInfo || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ë‹´ë‹¹ê¸°ì‚¬</span>
                        <span class="detail-value">${delivery.assignedDriver || 'ë¯¸ë°°ì •'}</span>
                    </div>
                </div>

                ${delivery.mainMemo ? `
                <div class="detail-section">
                    <h3 class="section-title">ë©”ëª¨</h3>
                    <div class="detail-item">
                        <span class="detail-label">ì£¼ìš”ë©”ëª¨</span>
                        <span class="detail-value">${delivery.mainMemo}</span>
                    </div>
                    ${delivery.driverMemo ? `
                    <div class="detail-item">
                        <span class="detail-label">ê¸°ì‚¬ë©”ëª¨</span>
                        <span class="detail-value">${delivery.driverMemo}</span>
                    </div>
                    ` : ''}
                </div>
                ` : ''}

                <div class="detail-section">
                    <button class="btn-primary" onclick="updateStatus('${delivery.id}')">ìƒíƒœ ë³€ê²½</button>
                </div>
            `;
        }

        // ë‚ ì§œ ë³€ê²½
        function changeDate(direction) {
            currentDate.setDate(currentDate.getDate() + direction);
            updateDateDisplay();
        }

        // ë‚ ì§œ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateDateDisplay() {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = 
                currentDate.toLocaleDateString('ko-KR', options);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const total = deliveries.length;
            const completed = deliveries.filter(d => d.status === 'delivered').length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
        }

        // ìƒíƒœ ë³€ê²½
        async function updateStatus(deliveryId) {
            const newStatus = prompt('ìƒˆ ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”:\\n1: ëŒ€ê¸°ì¤‘(pending)\\n2: ë°°ì†¡ì¤‘(in_transit)\\n3: ì™„ë£Œ(delivered)\\n4: ì·¨ì†Œ(cancelled)');
            
            const statusMap = {
                '1': 'pending',
                '2': 'in_transit', 
                '3': 'delivered',
                '4': 'cancelled'
            };
            
            const status = statusMap[newStatus];
            if (!status) return;

            try {
                const response = await fetch(`${API_BASE}/api/delivery/${deliveryId}/status`, {
                    method: 'PUT',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status })
                });

                if (response.ok) {
                    alert('ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    loadDeliveries();
                    showDeliveryList();
                } else {
                    alert('ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
                alert('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            authToken = '';
            currentUser = null;
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            showLogin();
        }
    </script>
</body>
</html>