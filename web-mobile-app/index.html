<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎØ∏ÎûòÏΩîÎ¶¨ÏïÑ Î∞∞ÏÜ° Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background-color: #fff;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header {
            background-color: #2196F3;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .hamburger {
            font-size: 24px;
            cursor: pointer;
        }

        .date-nav {
            background-color: #fff;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .date-nav button {
            background: none;
            border: none;
            font-size: 18px;
            color: #2196F3;
            cursor: pointer;
        }

        .current-date {
            font-size: 16px;
            font-weight: 500;
        }

        .stats {
            background-color: #f8f9fa;
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #e0e0e0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 600;
            color: #2196F3;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .delivery-list {
            padding: 20px;
        }

        .delivery-card {
            background-color: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #4CAF50;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .delivery-card:hover {
            transform: translateY(-2px);
        }

        .delivery-card.pending {
            border-left-color: #FF9800;
        }

        .delivery-card.in-transit {
            border-left-color: #2196F3;
        }

        .delivery-card.delivered {
            border-left-color: #4CAF50;
        }

        .delivery-card.cancelled {
            border-left-color: #f44336;
        }

        .delivery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .tracking-number {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
        }

        .status-badge.pending { background-color: #FF9800; }
        .status-badge.in-transit { background-color: #2196F3; }
        .status-badge.delivered { background-color: #4CAF50; }
        .status-badge.cancelled { background-color: #f44336; }

        .customer-name {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .customer-address {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .delivery-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #888;
        }

        .login-container {
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
        }

        .login-title {
            font-size: 28px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 40px;
            color: #2196F3;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #2196F3;
        }

        .btn-primary {
            width: 100%;
            padding: 14px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #1976D2;
        }

        .btn-secondary {
            width: 100%;
            padding: 14px;
            background-color: transparent;
            color: #2196F3;
            border: 1px solid #2196F3;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 12px;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background-color: #2196F3;
            color: white;
        }

        .hidden {
            display: none;
        }

        .detail-container {
            padding: 20px;
        }

        .back-button {
            background: none;
            border: none;
            color: #2196F3;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .detail-section {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 8px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-label {
            font-weight: 500;
            color: #666;
            flex: 1;
        }

        .detail-value {
            flex: 2;
            text-align: right;
            color: #333;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Î°úÍ∑∏Ïù∏ ÌôîÎ©¥ -->
        <div id="loginScreen" class="login-container">
            <h1 class="login-title">üöö ÎØ∏ÎûòÏΩîÎ¶¨ÏïÑ<br>Î∞∞ÏÜ° Í¥ÄÎ¶¨</h1>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">ÏÇ¨Ïö©Ïûê ID</label>
                    <input type="text" class="form-input" id="userId" placeholder="ÏÇ¨Ïö©Ïûê IDÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                    <input type="password" class="form-input" id="password" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                </div>
                
                <button type="submit" class="btn-primary">Î°úÍ∑∏Ïù∏</button>
                <button type="button" class="btn-secondary" onclick="showRegister()">ÌöåÏõêÍ∞ÄÏûÖ</button>
            </form>
        </div>

        <!-- ÌöåÏõêÍ∞ÄÏûÖ ÌôîÎ©¥ -->
        <div id="registerScreen" class="login-container hidden">
            <h1 class="login-title">ÌöåÏõêÍ∞ÄÏûÖ</h1>
            
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label">ÏÇ¨Ïö©Ïûê ID</label>
                    <input type="text" class="form-input" id="regUserId" placeholder="ÏÇ¨Ïö©Ïûê IDÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                    <input type="password" class="form-input" id="regPassword" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ïù¥Î¶Ñ</label>
                    <input type="text" class="form-input" id="regName" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>

                <div class="form-group">
                    <label class="form-label">Ï†ÑÌôîÎ≤àÌò∏</label>
                    <input type="tel" class="form-input" id="regPhone" placeholder="Ï†ÑÌôîÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>
                
                <button type="submit" class="btn-primary">ÌöåÏõêÍ∞ÄÏûÖ</button>
                <button type="button" class="btn-secondary" onclick="showLogin()">Î°úÍ∑∏Ïù∏ÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞</button>
            </form>
        </div>

        <!-- Î∞∞ÏÜ° Î™©Î°ù ÌôîÎ©¥ -->
        <div id="deliveryListScreen" class="hidden">
            <div class="header">
                <span class="hamburger">‚ò∞</span>
                <h1>ÎØ∏ÎûòÏΩîÎ¶¨ÏïÑ Î∞∞ÏÜ°Í¥ÄÎ¶¨</h1>
                <span onclick="logout()" style="cursor:pointer;">Î°úÍ∑∏ÏïÑÏõÉ</span>
            </div>

            <div class="date-nav">
                <button onclick="changeDate(-1)">‚Äπ</button>
                <span class="current-date" id="currentDate">2024ÎÖÑ 1Ïõî 15Ïùº</span>
                <button onclick="changeDate(1)">‚Ä∫</button>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalCount">5</div>
                    <div class="stat-label">Ï†ÑÏ≤¥Í±¥Ïàò</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="completedCount">2</div>
                    <div class="stat-label">ÏôÑÎ£åÍ±¥Ïàò</div>
                </div>
            </div>

            <div class="delivery-list" id="deliveryList">
                <!-- Î∞∞ÏÜ° Ïπ¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </div>

        <!-- Î∞∞ÏÜ° ÏÉÅÏÑ∏ ÌôîÎ©¥ -->
        <div id="deliveryDetailScreen" class="hidden">
            <div class="header">
                <button class="back-button" onclick="showDeliveryList()">‚Üê Îí§Î°ú</button>
                <h1>Î∞∞ÏÜ° ÏÉÅÏÑ∏Ï†ïÎ≥¥</h1>
                <span></span>
            </div>

            <div class="detail-container" id="detailContent">
                <!-- ÏÉÅÏÑ∏ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';
        let authToken = localStorage.getItem('token') || '';
        let currentUser = null;
        let currentDate = new Date();
        let deliveries = [];

        // ÎçîÎØ∏ Î∞∞ÏÜ° Îç∞Ïù¥ÌÑ∞
        const dummyDeliveries = [
            {
                id: 1,
                tracking_number: 'MK202401001',
                customerName: 'ÍπÄÏ≤†Ïàò',
                customerPhone: '010-1234-5678',
                customerAddress: 'ÏÑúÏö∏Ïãú Í∞ïÎÇ®Íµ¨ ÌÖåÌó§ÎûÄÎ°ú 123, 101Îèô 502Ìò∏',
                assignedDriver: 'Ïù¥Í∏∞ÏÇ¨',
                assignmentTime: '09:30',
                status: 'pending',
                requestType: 'ÏÉàÍ∞ÄÍµ¨ Î∞∞ÏÜ°',
                constructionType: 'Ï°∞Î¶Ω ÏÑ§Ïπò',
                shipmentType: 'ÏßÅÎ∞∞ÏÜ°',
                visitDate: '2024-01-15',
                visitTime: '14:00-16:00',
                furnitureCompany: 'ÌïúÏÉòÍ∞ÄÍµ¨',
                emergencyContact: '010-9999-8888',
                warehouseInfo: 'ÍπÄÌè¨Î¨ºÎ•òÏÑºÌÑ∞',
                orderGuidance: 'ÏôÑÎ£å',
                preNotification: 'ÌïÑÏöî',
                buildingType: 'ÏïÑÌååÌä∏',
                floorCount: '5Ï∏µ',
                elevatorAvailable: 'ÏûàÏùå',
                stairMovement: 'Î∂àÌïÑÏöî',
                ladderTruck: 'Î∂àÌïÑÏöî',
                disposal: 'ÏóÜÏùå',
                roomMovement: 'Í±∞Ïã§‚ÜíÏπ®Ïã§',
                wallConstruction: 'Î≤ΩÍ±∏Ïù¥ TV',
                tollgateCost: '5,000Ïõê',
                mainMemo: 'Ï°∞Ïã¨Ïä§ÎüΩÍ≤å Ïö¥Î∞ò ÏöîÏ≤≠',
                happyCallMemo: 'Í≥†Í∞ù Îß§Ïö∞ ÎßåÏ°±',
                productInfo: 'Ïπ®Ïã§ÏÑ∏Ìä∏ (Ïπ®ÎåÄ, Ïò∑Ïû•, ÌôîÏû•ÎåÄ)',
                furnitureRequest: 'Ïä§ÌÅ¨ÎûòÏπò Ï£ºÏùò',
                driverMemo: 'Ï£ºÏ∞® Ïñ¥Î†§ÏõÄ'
            },
            {
                id: 2,
                tracking_number: 'MK202401002',
                customerName: 'Î∞ïÏòÅÌù¨',
                customerPhone: '010-2345-6789',
                customerAddress: 'Î∂ÄÏÇ∞Ïãú Ìï¥Ïö¥ÎåÄÍµ¨ ÎßàÎ¶∞ÏãúÌã∞ 456, 202Ìò∏',
                assignedDriver: 'ÍπÄÍ∏∞ÏÇ¨',
                assignmentTime: '10:15',
                status: 'in_transit',
                requestType: 'ÏÉàÍ∞ÄÍµ¨ Î∞∞ÏÜ°',
                constructionType: 'Ï°∞Î¶Ω ÏÑ§Ïπò',
                productInfo: 'ÏÜåÌååÏÑ∏Ìä∏ (3Ïù∏ÏÜåÌåå, 2Ïù∏ÏÜåÌåå, ÌÖåÏù¥Î∏î)'
            },
            {
                id: 3,
                tracking_number: 'MK202401003',
                customerName: 'ÏµúÎØºÏàò',
                customerPhone: '010-3456-7890',
                customerAddress: 'ÎåÄÍµ¨Ïãú ÏàòÏÑ±Íµ¨ ÎèôÎåÄÍµ¨Î°ú 321, ÎπåÎùº 3Ï∏µ',
                assignedDriver: 'Î∞ïÍ∏∞ÏÇ¨',
                assignmentTime: '11:30',
                status: 'delivered',
                requestType: 'ÏÉàÍ∞ÄÍµ¨ Î∞∞ÏÜ°',
                constructionType: 'Ï°∞Î¶Ω ÏÑ§Ïπò',
                productInfo: 'Ïπ®Ïã§ÏÑ∏Ìä∏ (Ïπ®ÎåÄ, Îß§Ìä∏Î¶¨Ïä§)'
            },
            {
                id: 4,
                tracking_number: 'MK202401004',
                customerName: 'Ï†ïÏàòÏßÑ',
                customerPhone: '010-4567-8901',
                customerAddress: 'Ïù∏Ï≤úÏãú ÎÇ®ÎèôÍµ¨ Íµ¨ÏõîÎ°ú 789, ÏïÑÌååÌä∏ 15Îèô 1205Ìò∏',
                assignedDriver: 'Ïù¥Í∏∞ÏÇ¨',
                assignmentTime: '13:45',
                status: 'pending',
                requestType: 'ÏÉàÍ∞ÄÍµ¨ Î∞∞ÏÜ°',
                constructionType: 'Ï°∞Î¶Ω ÏÑ§Ïπò',
                productInfo: 'Ï£ºÎ∞©Í∞ÄÍµ¨ (Ïã±ÌÅ¨ÎåÄ, ÏàòÎÇ©Ïû•)'
            },
            {
                id: 5,
                tracking_number: 'MK202401005',
                customerName: 'ÌôçÍ∏∏Îèô',
                customerPhone: '010-5678-9012',
                customerAddress: 'Í¥ëÏ£ºÏãú ÏÑúÍµ¨ ÏÉÅÎ¨¥ÎåÄÎ°ú 654, Ïò§ÌîºÏä§ÌÖî 1201Ìò∏',
                assignedDriver: 'ÍπÄÍ∏∞ÏÇ¨',
                assignmentTime: '14:30',
                status: 'cancelled',
                requestType: 'ÏÉàÍ∞ÄÍµ¨ Î∞∞ÏÜ°',
                constructionType: 'Ï°∞Î¶Ω ÏÑ§Ïπò',
                productInfo: 'ÏÇ¨Î¨¥Ïö© Ï±ÖÏÉÅ Î∞è ÏùòÏûê'
            }
        ];

        // Ï¥àÍ∏∞Ìôî
        window.addEventListener('DOMContentLoaded', function() {
            if (authToken) {
                showDeliveryList();
            } else {
                showLogin();
            }
        });

        // ÌôîÎ©¥ Ï†ÑÌôò Ìï®ÏàòÎì§
        function showLogin() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
        }

        function showDeliveryList() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.remove('hidden');
            document.getElementById('deliveryDetailScreen').classList.add('hidden');
            
            loadDeliveries();
            updateDateDisplay();
            updateStats();
        }

        function showDeliveryDetail(delivery) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('deliveryListScreen').classList.add('hidden');
            document.getElementById('deliveryDetailScreen').classList.remove('hidden');
            
            loadDeliveryDetail(delivery);
        }

        // Î°úÍ∑∏Ïù∏ Ï≤òÎ¶¨
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userId = document.getElementById('userId').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId, password })
                });

                const result = await response.json();
                
                if (response.ok && result.token) {
                    authToken = result.token;
                    currentUser = result.user;
                    localStorage.setItem('token', authToken);
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    showDeliveryList();
                } else {
                    alert(result.error || 'Î°úÍ∑∏Ïù∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                console.error('Î°úÍ∑∏Ïù∏ Ïò§Î•ò:', error);
                alert('ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
            }
        });

        // ÌöåÏõêÍ∞ÄÏûÖ Ï≤òÎ¶¨
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const user_id = document.getElementById('regUserId').value;
            const password = document.getElementById('regPassword').value;
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;

            try {
                const response = await fetch(`${API_BASE}/api/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id, password, name, phone })
                });

                const result = await response.json();
                
                if (response.ok) {
                    alert('ÌöåÏõêÍ∞ÄÏûÖÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§. Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                    showLogin();
                } else {
                    alert(result.error || 'ÌöåÏõêÍ∞ÄÏûÖÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                console.error('ÌöåÏõêÍ∞ÄÏûÖ Ïò§Î•ò:', error);
                alert('ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
            }
        });

        // Î∞∞ÏÜ° Î™©Î°ù Î°úÎìú
        async function loadDeliveries() {
            try {
                const response = await fetch(`${API_BASE}/api/delivery/list`, {
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    deliveries = result.deliveries || dummyDeliveries;
                } else {
                    deliveries = dummyDeliveries;
                }
            } catch (error) {
                console.error('Î∞∞ÏÜ° Î™©Î°ù Î°úÎìú Ïò§Î•ò:', error);
                deliveries = dummyDeliveries;
            }

            renderDeliveryList();
        }

        // Î∞∞ÏÜ° Î™©Î°ù Î†åÎçîÎßÅ
        function renderDeliveryList() {
            const listContainer = document.getElementById('deliveryList');
            listContainer.innerHTML = '';

            deliveries.forEach(delivery => {
                const card = document.createElement('div');
                card.className = `delivery-card ${delivery.status}`;
                card.onclick = () => showDeliveryDetail(delivery);
                
                card.innerHTML = `
                    <div class="delivery-header">
                        <span class="tracking-number">${delivery.tracking_number}</span>
                        <span class="status-badge ${delivery.status}">${getStatusText(delivery.status)}</span>
                    </div>
                    <div class="customer-name">${delivery.customerName || delivery.receiver_name}</div>
                    <div class="customer-address">${delivery.customerAddress || delivery.receiver_address}</div>
                    <div class="delivery-info">
                        <span>Í∏∞ÏÇ¨: ${delivery.assignedDriver || 'ÎØ∏Î∞∞Ï†ï'}</span>
                        <span>ÏãúÍ∞Ñ: ${delivery.assignmentTime || 'ÎØ∏Ï†ï'}</span>
                    </div>
                `;
                
                listContainer.appendChild(card);
            });
        }

        // ÏÉÅÌÉú ÌÖçÏä§Ìä∏ Î≥ÄÌôò
        function getStatusText(status) {
            const statusMap = {
                'pending': 'ÎåÄÍ∏∞Ï§ë',
                'in_transit': 'Î∞∞ÏÜ°Ï§ë',
                'delivered': 'ÏôÑÎ£å',
                'cancelled': 'Ï∑®ÏÜå'
            };
            return statusMap[status] || status;
        }

        // Î∞∞ÏÜ° ÏÉÅÏÑ∏ Ï†ïÎ≥¥ Î°úÎìú
        function loadDeliveryDetail(delivery) {
            const detailContent = document.getElementById('detailContent');
            
            detailContent.innerHTML = `
                <div class="detail-section">
                    <h3 class="section-title">Í∏∞Î≥∏ Ï†ïÎ≥¥</h3>
                    <div class="detail-item">
                        <span class="detail-label">Ïö¥ÏÜ°Ïû•Î≤àÌò∏</span>
                        <span class="detail-value">${delivery.tracking_number}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Í≥†Í∞ùÎ™Ö</span>
                        <span class="detail-value">${delivery.customerName || delivery.receiver_name}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Ïó∞ÎùΩÏ≤ò</span>
                        <span class="detail-value">${delivery.customerPhone || delivery.receiver_phone}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Î∞∞ÏÜ°ÏÉÅÌÉú</span>
                        <span class="detail-value">${getStatusText(delivery.status)}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3 class="section-title">Î∞∞ÏÜ° Ï£ºÏÜå</h3>
                    <div class="detail-item">
                        <span class="detail-label">Ï£ºÏÜå</span>
                        <span class="detail-value">${delivery.customerAddress || delivery.receiver_address}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3 class="section-title">Î∞∞ÏÜ° Ï†ïÎ≥¥</h3>
                    <div class="detail-item">
                        <span class="detail-label">ÏöîÏ≤≠ÏÇ¨Ìï≠</span>
                        <span class="detail-value">${delivery.requestType || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ÏãúÍ≥µÏú†Ìòï</span>
                        <span class="detail-value">${delivery.constructionType || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ÏÉÅÌíàÏ†ïÎ≥¥</span>
                        <span class="detail-value">${delivery.productInfo || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Îã¥ÎãπÍ∏∞ÏÇ¨</span>
                        <span class="detail-value">${delivery.assignedDriver || 'ÎØ∏Î∞∞Ï†ï'}</span>
                    </div>
                </div>

                ${delivery.mainMemo ? `
                <div class="detail-section">
                    <h3 class="section-title">Î©îÎ™®</h3>
                    <div class="detail-item">
                        <span class="detail-label">Ï£ºÏöîÎ©îÎ™®</span>
                        <span class="detail-value">${delivery.mainMemo}</span>
                    </div>
                    ${delivery.driverMemo ? `
                    <div class="detail-item">
                        <span class="detail-label">Í∏∞ÏÇ¨Î©îÎ™®</span>
                        <span class="detail-value">${delivery.driverMemo}</span>
                    </div>
                    ` : ''}
                </div>
                ` : ''}

                <div class="detail-section">
                    <button class="btn-primary" onclick="updateStatus('${delivery.id}')">ÏÉÅÌÉú Î≥ÄÍ≤Ω</button>
                </div>
            `;
        }

        // ÎÇ†Ïßú Î≥ÄÍ≤Ω
        function changeDate(direction) {
            currentDate.setDate(currentDate.getDate() + direction);
            updateDateDisplay();
        }

        // ÎÇ†Ïßú ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateDateDisplay() {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = 
                currentDate.toLocaleDateString('ko-KR', options);
        }

        // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateStats() {
            const total = deliveries.length;
            const completed = deliveries.filter(d => d.status === 'delivered').length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
        }

        // ÏÉÅÌÉú Î≥ÄÍ≤Ω
        async function updateStatus(deliveryId) {
            const newStatus = prompt('ÏÉà ÏÉÅÌÉúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî:\\n1: ÎåÄÍ∏∞Ï§ë(pending)\\n2: Î∞∞ÏÜ°Ï§ë(in_transit)\\n3: ÏôÑÎ£å(delivered)\\n4: Ï∑®ÏÜå(cancelled)');
            
            const statusMap = {
                '1': 'pending',
                '2': 'in_transit', 
                '3': 'delivered',
                '4': 'cancelled'
            };
            
            const status = statusMap[newStatus];
            if (!status) return;

            try {
                const response = await fetch(`${API_BASE}/api/delivery/${deliveryId}/status`, {
                    method: 'PUT',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status })
                });

                if (response.ok) {
                    alert('ÏÉÅÌÉúÍ∞Ä ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.');
                    loadDeliveries();
                    showDeliveryList();
                } else {
                    alert('ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                console.error('ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ Ïò§Î•ò:', error);
                alert('ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
            }
        }

        // Î°úÍ∑∏ÏïÑÏõÉ
        function logout() {
            authToken = '';
            currentUser = null;
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            showLogin();
        }
    </script>
</body>
</html>